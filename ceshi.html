<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>注册问问ID</title>
	<link rel="stylesheet" href="css/ceshi.css">
</head>
<body>
	<div class="box">
		<img src="img/logo2.png" alt="">
		<input class="sub" id="subn" type="text" placeholder="手机号" style="border-bottom:1px solid #bbc8cc;">
		<span id="spBt" style="display: none;">请输入正确手机号</span>
		<input id="subMit" type="password" placeholder="密码">
		<div class="imgas" id="imgas">
			<img id="igs1" src="img/close-eye.png" alt="" style="display: block;">
			<img id="igs2" src="img/open-eye.png" alt="" style="display: none;">
		</div>
		<ul>
			<li id="liId1" style="background-image: url(img/fill.png)">至少为8位</li>
			<li id="liId2" style="background-image: url(img/fill.png)">至少包含一个数字</li>
			<li id="liId3" style="background-image: url(img/fill.png)">至少包含一个字母</li>
		</ul>
		<div class="btna">
			<button id="sub_id" type="submit" class="btn btn-default">立即注册</button>
			<div id="messageBox"></div>
		</div>
		<div class="p">
			<p>点击"立即注册"代表您同意遵守</p>
			<p><a href="">用户协议</a> 和 <a href="">隐私条款</a> 以及 <a href="">儿童隐私政策</a></p>
		</div>
		<a class="cla" href="denglu.html">返回登录</a>
	</div>
	<p class="pl">Copyright © 2019 Mobvoi Inc. All Rights Reserved. 北京羽扇智信息科技有限责任公司 京ICP备14058077号-1</p>
</body>
</html>
<script src="js/cookieTools.js"></script>
<script>
	
	$("#imgas").onclick = function(){
		if($("#igs1").style.display == "block"){
			$("#igs2").style.display = "block";
			$("#igs1").style.display = "none";
			$("#subMit").type = "text"
		}else if($("#igs2").style.display = "block"){
			$("#igs1").style.display = "block";
			$("#igs2").style.display = "none";
			$("#subMit").type = "password"
		}
	}
	$("#subn").onblur = function(){
		var r =  /^1[3-9]\d{9}$/ 

  	 	if(r.test(this.value)){
  	 		$("#spBt").style.display="1px solid #bbc8cc";
  	 	}else{
  	 		$("#spBt").style.display="block";
  	 		$("#subn").style.borderBottom= "1px solid #d33253";
  	 	}
  	}
  	$("#subn").onfocus= function(){
 		$("#spBt").style.display="none";
 		$("#subn").style.borderBottom= "1px solid #bbc8cc";
  	}
  	$("#subMit").onblur = function(){
  		var r;
  		if(r =  /\w{8}/){
			if(r.test(this.value)){
		  	 		$("#liId1").style.backgroundImage="url(img/success-icon.png)";
		  	 	}else{
		  	 		$("#liId1").style.backgroundImage="url(img/fill.png)";
	  	 	}
  		}
  		if(r =  /\d/ ){
  			if(r.test(this.value)){
		  	 		$("#liId2").style.backgroundImage="url(img/success-icon.png)";
		  	 	}else{
		  	 		$("#liId2").style.backgroundImage="url(img/fill.png)";
	  	 	}
	  	 }
	  	 if(r =  /[a-zA-Z]/){
			if(r.test(this.value)){
				  	 $("#liId3").style.backgroundImage="url(img/success-icon.png)";
		  	 	}else{
		  	 		$("#liId3").style.backgroundImage="url(img/fill.png)";
	  	 	}
	  	}
  	}

$("#sub_id").onclick = function(){
    //1、
    let xhr = new XMLHttpRequest();

		xhr.open("post","php/zhuce.php",true);

		xhr.onreadystatechange = function(){
			if(xhr.readyState==4 && xhr.status==200){
	            if(xhr.responseText=="-1"){
	                $("#messageBox").style.color ="red";
	                $("#messageBox").innerHTML ="用户名被人使用";
	            }else if(xhr.responseText=="0"){
	                $("#messageBox").style.color ="red";
	                $("#messageBox").innerHTML ="注册失败";
	            }else if(xhr.responseText=="1"){
	            	addCookie("userphone",$("#subn").value,7);
	                $("#messageBox").style.color ="greenyellow";
	                $("#messageBox").innerHTML ="注册成功，请<a href='denglu.html'>登录</a>";
	            }
	        }
		}
		//post方式：设置请求头
		xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
		//post方式：把传给服务器端数据（键值对）放在send函数的参数里
		let sendstr = `userphone=${$("#subn").value}&userpass=${$("#subMit").value}`;
		xhr.send(sendstr);

}

function check(){
    //非空判断：
    if(userphone.value=="" || userpass.value=="" || checkpass.value==""){
        alert("亲，内容不能为空");
        return false;//阻止浏览器的默认行为
    }
 }	

	function $(str){
	    if(str[0]=="#"){
	        return document.getElementById(str.substring(1));
	    }else if(str[0]=="."){
	        return document.getElementsByClassName(str.substring(1));
	    }else{
	        return document.getElementsByTagName(str);
	    }
	}

</script>